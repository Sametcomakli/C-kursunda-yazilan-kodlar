#include "studentlist.h"
#include <stdlib.h>
#include <stdio.h>

typedef struct _Node {
	Student s;
	struct _Node* pnext;
}Node;

typedef struct List {
	Node* mpfirst;
	int mcount;
}*ListHandle;



//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

static Node* create_node(void)
{
	Node* pd = (Node *)malloc(sizeof(Node));
	if (!pd) {
		fprintf(stderr, "bellek yetersiz\n");
		exit(EXIT_FAILURE);
	}
	return pd;
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

ListHandle create_list(void)
{
	ListHandle p = (ListHandle)malloc(sizeof(struct List));
	if (!p) {
		fprintf(stderr, "bellek yetersiz\n");
		exit(EXIT_FAILURE);
	}

	p->mcount = 0;
	p->mpfirst = NULL;

	return p;
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

void destroy_list(ListHandle h)
{
	make_empty(h);
	free(h);
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

int get_size(ListHandle h)
{
	return h->mcount;
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

int isempty(ListHandle h)
{
	//return h->mpfirst == NULL;
	return h->mcount == 0;
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

void print_list(ListHandle h)
{
	for (Node* pnode = h->mpfirst; pnode != NULL; pnode = pnode->pnext) {
		print_student(&pnode->s);
	}
	printf("\n");

}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

void push_front(ListHandle h, const Student* p)
{
	Node* pnewnode = create_node();
	pnewnode->s = *p;
	pnewnode->pnext = h->mpfirst;
	h->mpfirst = pnewnode;
	++h->mcount;
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

void pop_front(ListHandle h)
{
	if (isempty(h)) {
		fprintf(stderr, "bos liste hatasi\n");
		exit(EXIT_FAILURE);
	}
	Node* ptemp = h->mpfirst;
	h->mpfirst = h->mpfirst->pnext;
	free(ptemp);
	--h->mcount;
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

void get_first(ListHandle h, Student* p)
{
	if (isempty(h)) {
		fprintf(stderr, "bos liste hatasi\n");
		exit(EXIT_FAILURE);
	}

	*p = h->mpfirst->s;
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

void make_empty(ListHandle h)
{
	while (!isempty(h)) {
		pop_front(h);
	}
}

//----------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------

